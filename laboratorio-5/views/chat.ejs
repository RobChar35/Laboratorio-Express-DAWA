<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">

    <style>
        .bg-light {
            background-image: url("https://e1.pxfuel.com/desktop-wallpaper/710/390/desktop-wallpaper-whatsapp-original-chat-backgrounds-%C2%B7-github-chat.jpg");
            background-size: cover;
        }
    </style>

    <script src="/socket.io/socket.io.js"></script>
    
    <script>
        // Conexión de Socket.IO al servidor
        var socket = io();
        
        // Función para enviar mensajes del chat 1
        function enviarMensaje1() {
            var mensaje = document.getElementById('mensaje1').value;
            socket.emit('chat message 1', mensaje);
            document.getElementById('mensaje1').value = '';
            return false;
        }
        
        // Función para recibir mensajes del chat 1
        socket.on('chat message 1', function(msg){
            var listaMensajes = document.getElementById('lista-mensajes');
            var mensaje = document.createElement('li');
            mensaje.textContent = "<%= username1 %>: " + msg;
            listaMensajes.appendChild(mensaje);
        });
        
        // Función para enviar mensajes del chat 2
        function enviarMensaje2() {
            var mensaje = document.getElementById('mensaje2').value;
            socket.emit('chat message 2', mensaje);
            document.getElementById('mensaje2').value = '';
            return false;
        }

        // Función para recibir mensajes del chat 2
        socket.on('chat message 2', function(msg){
            var listaMensajes = document.getElementById('lista-mensajes');
            var mensaje = document.createElement('li');
            mensaje.textContent = "<%= username2 %>: " + msg;
            listaMensajes.appendChild(mensaje);
        });

    </script>
</head>
<body>
    <div class="container">
        <div class="row" style="display: flex; align-items: center;">
            <div class="col-3">
                <div class="bg-light rounded d-flex flex-column justify-content-between" style="min-height: 600px;">
                    <div class="d-flex p-3" style="background-color: #075E54; height: 80px;">
                        <img src="<%= username1Profile %>" alt="" class="d-block rounded-circle" width="50" height="50">
                        <h1 style="color: white; font-size: 30px; margin-left: 20px;"><%= username1 %></h1>
                    </div>
                    <div class="flex-grow-1 my-3"></div>

                    <div style="margin: 10px;">
                        <form onsubmit="return enviarMensaje1()">
                            <input id="mensaje1" class="form-control d-inline-block" autocomplete="off" style="width: 200px;">
                            <button class="btn btn-primary d-inline-block">Enviar</button>
                        </form>
                    </div>
                </div>
            </div>

            <!--Mensajes-->
            <div class="col-5 mx-auto">
                <div class="bg-light p-3 rounded" style="min-height: 800px;">
                    <ul id="lista-mensajes" class="list-group" style="height: 100%;"></ul>
                </div>
            </div>

            <div class="col-3 mx-auto"> 
                <div class="bg-light rounded d-flex flex-column justify-content-between" style="min-height: 600px;">
                    <div class="d-flex p-3" style="background-color: #075E54; height: 80px;">
                        <img src="<%= username2Profile %>" alt="" class="d-block rounded-circle" width="50" height="50">
                        <h1 style="color: white; font-size: 30px; margin-left: 20px;"><%= username2 %></h1>
                    </div>
                    <div class="flex-grow-1 my-3"></div>

                    <div style="margin: 10px;">
                        <form onsubmit="return enviarMensaje2()">
                            <input id="mensaje1" class="form-control d-inline-block" autocomplete="off" style="width: 200px;">
                            <button class="btn btn-primary d-inline-block">Enviar</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js" integrity="sha384-zYPOMqeu1DAVkHiLqWBUTcbYfZ8osu1Nd6Z89ify25QV9guujx43ITvfi12/QExE" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js" integrity="sha384-Y4oOpwW3duJdCWv5ly8SCFYWqFDsfob/3GkgExXKV4idmbt98QcxXYs9UoXAB7BZ" crossorigin="anonymous"></script>
</body>
</html>